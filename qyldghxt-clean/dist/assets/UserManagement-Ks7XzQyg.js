import{a as e,j as s}from"./index-ByQWdRVi.js";import{r as t}from"./charts--DrkC4h1.js";import{D as r}from"./DeleteConfirmDialog-CRlob68K.js";import{i as a,O as l,E as i,a as n,u as o,X as d,$ as c,Q as x}from"./ui-CyUNfsEX.js";import"./vendor-De9qiMg1.js";import"./router-BWTJJsff.js";import"./pdf-60kGjG4V.js";import"./utils-d68qSfg_.js";const m=()=>{const{getUsers:m,addUser:u,updateUser:p,deleteUser:h}=e(),[g,b]=t.useState([]),[j,f]=t.useState(!1),[y,N]=t.useState(null),[v,w]=t.useState(!1),[k,C]=t.useState({isOpen:!1,itemId:null,itemName:""}),[z,O]=t.useState({username:"",password:"",role:"",status:"启用"});t.useEffect(()=>{S()},[]);const S=async()=>{try{const e=await m();e.success&&b(e.data||[])}catch(e){console.error("加载用户数据失败:",e),b([])}},I=()=>{O({username:"",password:"",role:"",status:"启用"}),f(!1),N(null),w(!1)};return s.jsxs("div",{className:"space-y-6 p-6",children:[s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 p-6 rounded-xl shadow-lg border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl shadow-lg",children:s.jsx(a,{size:32,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"用户管理"}),s.jsx("p",{className:"text-gray-600",children:"管理系统用户账号和权限设置"})]})]}),s.jsxs("button",{onClick:()=>f(!j),className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl hover:from-blue-600 hover:to-purple-700 transition-all duration-200 transform hover:scale-105 shadow-lg flex items-center space-x-2",children:[s.jsx(l,{size:18}),s.jsx("span",{children:"新增用户"})]})]}),j&&s.jsxs("form",{onSubmit:async e=>{e.preventDefault();const s={...z,lastLogin:y?g.find(e=>e.id===y)?.lastLogin:"从未登录"};if(y){return!!(await p(y,s)).success&&(await S(),I(),!0)}return!!(await u(s)).success&&(await S(),I(),!0)},className:"mb-6 p-6 bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl border border-gray-200 shadow-lg",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:["用户名 ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",value:z.username,onChange:e=>O({...z,username:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:["密码 ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:v?"text":"password",value:z.password,onChange:e=>O({...z,password:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 pr-10",required:!0}),s.jsx("button",{type:"button",onClick:()=>w(!v),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 transition-colors duration-200",children:v?s.jsx(i,{size:18}):s.jsx(n,{size:18})})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:["角色 ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{value:z.role,onChange:e=>O({...z,role:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0,children:[s.jsx("option",{value:"",children:"请选择角色"}),["管理员","普通用户","审核员","操作员"].map(e=>s.jsx("option",{value:e,children:e},e))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:["状态 ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("select",{value:z.status,onChange:e=>O({...z,status:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0,children:["启用","禁用"].map(e=>s.jsx("option",{value:e,children:e},e))})]})]}),s.jsxs("div",{className:"flex items-center space-x-3 mt-6",children:[s.jsxs("button",{type:"submit",className:"px-6 py-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-200 transform hover:scale-105 shadow-lg flex items-center space-x-2",children:[s.jsx(o,{size:18}),s.jsx("span",{children:y?"更新":"保存"})]}),s.jsxs("button",{type:"button",onClick:I,className:"px-6 py-2 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-lg hover:from-gray-600 hover:to-gray-700 transition-all duration-200 transform hover:scale-105 shadow-lg flex items-center space-x-2",children:[s.jsx(d,{size:18}),s.jsx("span",{children:"取消"})]})]})]}),s.jsx("div",{className:"overflow-x-auto rounded-xl border border-gray-200 shadow-lg",children:s.jsxs("table",{className:"min-w-full bg-white",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-gradient-to-r from-blue-500 to-purple-600",children:[s.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white uppercase tracking-wider",children:"用户名"}),s.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white uppercase tracking-wider",children:"角色"}),s.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white uppercase tracking-wider",children:"状态"}),s.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white uppercase tracking-wider",children:"最后登录时间"}),s.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white uppercase tracking-wider",children:"操作"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:g.map(e=>{return s.jsxs("tr",{className:"hover:bg-gradient-to-r hover:from-blue-50 hover:to-purple-50 transition-all duration-200",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(a,{size:16,className:"text-gray-400"}),s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:e.username})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r=e.role,{"管理员":"bg-purple-100 text-purple-800","普通用户":"bg-blue-100 text-blue-800","审核员":"bg-orange-100 text-orange-800","操作员":"bg-gray-100 text-gray-800"}[r]||"bg-gray-100 text-gray-800"}`,children:e.role})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+(t=e.status,"启用"===t?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.status})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-800",children:e.lastLogin}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("button",{onClick:()=>(e=>{O({username:e.username,password:e.password,role:e.role,status:e.status}),f(!0),N(e.id)})(e),className:"p-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all duration-200 transform hover:scale-110 shadow-md",children:s.jsx(c,{size:16})}),s.jsx("button",{onClick:()=>(e=>{C({isOpen:!0,itemId:e.id,itemName:e.username})})(e),className:"p-2 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-200 transform hover:scale-110 shadow-md",children:s.jsx(x,{size:16})})]})})]},e.id);var t,r})})]})}),s.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[s.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"权限说明："}),s.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"管理员："}),"拥有所有权限，可以管理用户、修改系统设置"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"审核员："}),"可以审核和批准计划、查看所有数据"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"操作员："}),"可以添加和编辑计划数据"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"普通用户："}),"只能查看分配给自己的数据"]})]})]})]}),s.jsx(r,{isOpen:k.isOpen,itemName:k.itemName,itemType:"用户",onConfirm:async()=>!!(await h(k.itemId)).success&&(await S(),C({isOpen:!1,itemId:null,itemName:""}),!0),onCancel:()=>{C({isOpen:!1,itemId:null,itemName:""})}})]})};export{m as default};

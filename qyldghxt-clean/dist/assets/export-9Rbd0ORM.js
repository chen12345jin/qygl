import{u as e,w as t}from"./utils-d68qSfg_.js";import{h as n,E as a}from"./pdf-60kGjG4V.js";const r={departments:{name:"部门名称",code:"部门编码",parent_id:"上级部门",manager:"部门负责人",description:"部门描述",created_at:"创建时间"},employees:{name:"姓名",employee_id:"工号",department:"部门",position:"职位",phone:"电话",email:"邮箱",hire_date:"入职日期",status:"状态",created_at:"创建时间"},departmentTargets:{year:"年度",department:"部门",target_type:"目标类型",month:"月份",sales_amount:"销售额",profit:"利润",completion_rate:"完成率",notes:"备注",created_at:"创建时间"},annualWorkPlans:{year:"年度",department:"部门",plan_name:"计划名称",objective:"目标",key_tasks:"关键任务",timeline:"时间线",resources:"资源需求",success_criteria:"成功标准",responsible_person:"负责人",status:"状态",created_at:"创建时间"},majorEvents:{year:"年度",event_name:"事件名称",event_type:"事件类型",priority:"优先级",description:"描述",impact:"影响",responsible_department:"负责部门",start_date:"开始日期",end_date:"结束日期",status:"状态",created_at:"创建时间"},monthlyProgress:{year:"年度",month:"月份",department:"部门",task_name:"任务名称",target:"目标",actual:"实际",progress:"进度",issues:"问题",next_steps:"下一步",responsible_person:"负责人",created_at:"创建时间"},actionPlans:{what:"做什么",why:"为什么",who:"谁来做",when:"什么时候",where:"在哪里",how:"怎么做",how_much:"多少钱",department:"部门",priority:"优先级",status:"状态",created_at:"创建时间"}},o=(n,a,o="Sheet1",s="default")=>{if(!n||!Array.isArray(n)||0===n.length)throw new Error("没有数据可以导出");try{const i=r[s]||{},c=n.map(e=>{const t={};return 0===Object.keys(i).length?Object.keys(e).forEach(n=>{let a=e[n];if((n.includes("date")||n.includes("_at"))&&a)try{a=new Date(a).toLocaleString("zh-CN")}catch(r){}"boolean"==typeof a&&(a=a?"是":"否"),null==a&&(a=""),t[n]=a}):Object.keys(e).forEach(n=>{const a=i[n]||n;let r=e[n];if((n.includes("date")||n.includes("_at"))&&r)try{r=new Date(r).toLocaleString("zh-CN")}catch(o){}"boolean"==typeof r&&(r=r?"是":"否"),null==r&&(r=""),t[a]=r}),t}),l=e.book_new(),p=e.json_to_sheet(c),d=[];c.length>0&&(Object.keys(c[0]).forEach(e=>{const t=Math.max(e.length,...c.map(t=>String(t[e]||"").length));d.push({wch:Math.min(t+2,50)})}),p["!cols"]=d),e.book_append_sheet(l,p,o);const m=`${a}_${(new Date).toISOString().split("T")[0]}.xlsx`;return t(l,m),{success:!0,filename:m}}catch(i){throw console.error("Excel导出失败:",i),new Error(`Excel导出失败: ${i.message}`)}},s=async(e,t)=>{try{const r=document.getElementById(e);if(!r)throw new Error("找不到要导出的元素");const o=await n(r,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff"}),s=o.toDataURL("image/png"),i=new a({orientation:o.width>o.height?"landscape":"portrait",unit:"mm",format:"a4"}),c=i.internal.pageSize.getWidth(),l=i.internal.pageSize.getHeight(),p=o.width,d=o.height,m=Math.min(c/p,l/d),h=(c-p*m)/2,u=30;i.addImage(s,"PNG",h,u,p*m,d*m),i.setFontSize(16),i.text(t,c/2,20,{align:"center"});const g=`${t}_${(new Date).toISOString().split("T")[0]}.pdf`;return i.save(g),{success:!0,filename:g}}catch(r){throw console.error("PDF导出失败:",r),new Error(`PDF导出失败: ${r.message}`)}},i=e=>{try{const t=document.getElementById(e);if(!t)throw new Error("找不到要打印的元素");const n=window.open("","_blank"),a=`\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <meta charset="utf-8">\n          <title>打印页面</title>\n          <style>\n            ${Array.from(document.styleSheets).map(e=>{try{return Array.from(e.cssRules).map(e=>e.cssText).join("\n")}catch(t){return""}}).join("\n")}\n            @media print {\n              body { margin: 0; padding: 20px; }\n              .no-print { display: none !important; }\n              table { page-break-inside: avoid; }\n              .annual-planning-table { font-size: 12px; }\n              .annual-planning-table th,\n              .annual-planning-table td { \n                padding: 8px 4px;\n                border: 1px solid #000;\n              }\n            }\n          </style>\n        </head>\n        <body>\n          ${t.outerHTML}\n          <script>\n            window.onload = function() {\n              window.print();\n              window.close();\n            }\n          <\/script>\n        </body>\n      </html>\n    `;return n.document.write(a),n.document.close(),{success:!0,message:"打印窗口已打开"}}catch(t){throw console.error("打印失败:",t),new Error(`打印失败: ${t.message}`)}};export{s as a,o as e,i as p};

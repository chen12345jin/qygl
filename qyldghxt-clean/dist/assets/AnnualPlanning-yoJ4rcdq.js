import{j as e,a as r}from"./index-ByQWdRVi.js";import{r as t}from"./charts--DrkC4h1.js";import{a as s}from"./export-9Rbd0ORM.js";import{F as a,D as l,X as n,z as o,C as i,P as d,s as c,t as x,u as h,T as m,o as p,v as b,w as g,U as y,x as u,A as j,y as f,G as v,J as N,c as w,K as k,d as z,N as _,h as C,b as D,O as F,Q as P}from"./ui-CyUNfsEX.js";import"./vendor-De9qiMg1.js";import"./router-BWTJJsff.js";import"./pdf-60kGjG4V.js";import"./utils-d68qSfg_.js";const W=({isOpen:r,onClose:t,title:i,data:d,columns:c,filename:x="document"})=>{if(!r)return null;const h=Array.isArray(d)?d:[],m=Array.isArray(c)?c:[];return e.jsxs("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center p-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gray-50",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[e.jsx(a,{className:"mr-2",size:20}),"打印预览 - ",i]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:async()=>{try{await s("print-content",x),o.success("PDF导出成功")}catch(e){o.error("PDF导出失败"),console.error("PDF export error:",e)}},className:"btn-secondary flex items-center space-x-2",children:[e.jsx(l,{size:16}),e.jsx("span",{children:"下载PDF"})]}),e.jsx("button",{onClick:()=>{window.print()},className:"btn-primary",children:"打印"}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-200 rounded-lg",children:e.jsx(n,{size:20})})]})]}),e.jsx("div",{className:"overflow-auto max-h-[calc(90vh-80px)]",children:e.jsxs("div",{id:"print-content",className:"p-8 bg-white",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:i}),e.jsxs("p",{className:"text-gray-600",children:["生成时间：",(new Date).toLocaleString("zh-CN")]})]}),h.length>0&&m.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsx("tr",{className:"bg-gray-100",children:m.map((r,t)=>e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left font-semibold",children:r.label||r.key||`列${t+1}`},r.key||t))})}),e.jsx("tbody",{children:h.map((r,t)=>e.jsx("tr",{className:"hover:bg-gray-50",children:m.map((s,a)=>e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.render?s.render(r[s.key],r):r[s.key]||""},`${t}-${s.key||a}`))},r.id||t))})]})}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"暂无数据"}),h.length>0&&e.jsx("div",{className:"mt-8 pt-4 border-t border-gray-200",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["共 ",h.length," 条记录"]})}),e.jsx("div",{className:"mt-12 pt-4 border-t border-gray-200 text-center text-sm text-gray-500",children:e.jsx("p",{children:"企业年度规划系统 - 系统自动生成"})})]})})]}),e.jsx("style",{children:"\n        @media print {\n          .fixed {\n            position: static !important;\n          }\n          \n          .bg-black {\n            background: white !important;\n          }\n          \n          .shadow-xl {\n            box-shadow: none !important;\n          }\n          \n          .border-b, .bg-gray-50 {\n            display: none !important;\n          }\n          \n          #print-content {\n            padding: 0 !important;\n          }\n          \n          .overflow-auto {\n            overflow: visible !important;\n          }\n          \n          .max-h-\\[calc\\(90vh-80px\\)\\] {\n            max-height: none !important;\n          }\n          \n          table {\n            page-break-inside: auto;\n          }\n          \n          tr {\n            page-break-inside: avoid;\n            page-break-after: auto;\n          }\n          \n          thead {\n            display: table-header-group;\n          }\n          \n          tfoot {\n            display: table-footer-group;\n          }\n        }\n      "})]})},A=()=>{const{getAnnualPlans:n,addAnnualPlan:A,updateAnnualPlan:$,deleteAnnualPlan:S}=r(),[Y,H]=t.useState([]),[K,E]=t.useState(!1),[O,B]=t.useState({row:null,col:null,sheet:null}),[M,V]=t.useState("planning"),[G,J]=t.useState({year:(new Date).getFullYear(),title:"年度工作规划",data:Array.from({length:12},(e,r)=>({month:r+1,theme:["规划导航月","招聘月","人才引备战月","产品月","产品月","年中总结月","学习月","备战月","抢战月","丰收月","冲刺月","总结月"][r],goals:"",tasks:"",resources:"",timeline:"",responsible:"",notes:""}))}),[L,Q]=t.useState({year:(new Date).getFullYear(),title:"年度大事件提炼",events:Array.from({length:12},(e,r)=>({month:r+1,event_name:"",event_type:"",importance:"高",description:"",impact:"",lessons:""}))}),[T,U]=t.useState({year:(new Date).getFullYear(),title:"月度推进计划表",plans:Array.from({length:12},(e,r)=>({month:r+1,objectives:"",key_tasks:"",deliverables:"",milestones:"",resources_needed:"",risks:"",success_metrics:""}))}),[q,I]=t.useState({year:(new Date).getFullYear(),title:"5W2H行动计划表",actions:[]}),R=[{key:"planning",label:"年度工作规划",icon:a},{key:"events",label:"大事件提炼",icon:a},{key:"monthly",label:"月度推进计划",icon:a},{key:"action",label:"5W2H行动计划",icon:a}];t.useEffect(()=>{X()},[]);const X=async()=>{try{const[e,r,t,s]=await Promise.all([n({sheet_type:"planning"}),n({sheet_type:"events"}),n({sheet_type:"monthly"}),n({sheet_type:"action"})]);e.success&&e.data&&J(r=>({...r,data:e.data.length>0?e.data:r.data})),r.success&&r.data&&Q(e=>({...e,events:r.data.length>0?r.data:e.events})),t.success&&t.data&&U(e=>({...e,plans:t.data.length>0?t.data:e.plans})),s.success&&s.data&&I(e=>({...e,actions:s.data.length>0?s.data:e.actions})),H(e.data||[])}catch(e){console.error("加载数据失败:",e)}},Z=async e=>{try{const r={planning:G,events:L,monthly:T,action:q}[e],t=r[{planning:"data",events:"events",monthly:"plans",action:"actions"}[e]].map(t=>A({...t,sheet_type:e,year:r.year})),s=await Promise.all(t);s.every(e=>e.success)?(o.success("保存成功"),X()):o.error("部分数据保存失败")}catch(r){console.error("保存失败:",r),o.error("保存失败")}},ee=(e,r,t,s)=>{const a={planning:J,events:Q,monthly:U,action:I}[e];a&&(a(a=>{const l={...a},n={planning:"data",events:"events",monthly:"plans",action:"actions"}[e];return l[n]&&l[n][r]&&(l[n][r]={...l[n][r],[t]:s}),l}),B({row:null,col:null,sheet:null}),o.success("数据已更新"))},re=({sheet:r,index:t,field:s,value:a,type:l="text"})=>O.row===t&&O.col===s&&O.sheet===r?"textarea"===l?e.jsx("textarea",{defaultValue:a||"",autoFocus:!0,onBlur:e=>ee(r,t,s,e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||ee(r,t,s,e.target.value)},className:"w-full border-0 bg-yellow-100 text-sm p-2 resize-none",rows:"3"}):e.jsx("input",{type:l,defaultValue:a||"",autoFocus:!0,onBlur:e=>ee(r,t,s,e.target.value),onKeyPress:e=>{"Enter"===e.key&&ee(r,t,s,e.target.value)},className:"w-full border-0 bg-yellow-100 text-center text-sm p-1"}):e.jsx("div",{onClick:()=>B({row:t,col:s,sheet:r}),className:"cursor-pointer hover:bg-blue-50 p-2 min-h-12 flex items-center justify-center text-center",title:"点击编辑",children:a||""}),te=()=>{I(e=>({...e,actions:[...e.actions,{id:Date.now(),what:"",why:"",who:"",when:"",where:"",how:"",how_much:"",status:"计划中"}]}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-700 rounded-3xl shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent"}),e.jsx("div",{className:"relative z-10 p-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-white/20 backdrop-blur-sm rounded-2xl shadow-lg",children:e.jsx(i,{size:28,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-1",children:"年度规划表"}),e.jsx("p",{className:"text-blue-100 text-lg",children:"年度工作规划与执行管理"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-white/80 text-sm",children:"当前年度"}),e.jsxs("div",{className:"text-white text-xl font-semibold",children:[(new Date).getFullYear(),"年"]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>E(!0),className:"px-6 py-3 bg-white/20 backdrop-blur-sm text-white rounded-xl hover:bg-white/30 transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center space-x-2 border border-white/30",children:[e.jsx(d,{size:18}),e.jsx("span",{children:"打印预览"})]}),e.jsxs("button",{onClick:()=>{var e;s(`${e=M}-table`,`${R.find(r=>r.key===e)?.label}_${(new Date).getFullYear()}`)},className:"px-6 py-3 bg-gradient-to-r from-green-500 to-teal-600 text-white rounded-xl hover:from-green-600 hover:to-teal-700 transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center space-x-2",children:[e.jsx(l,{size:18}),e.jsx("span",{children:"导出PDF"})]})]})]})]})})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-gray-100 mb-6 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg",children:e.jsx(c,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"数据表格"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"选择要查看和编辑的表格类型"})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["当前选择: ",R.find(e=>e.key===M)?.label]})]}),e.jsx("nav",{className:"flex space-x-4",children:R.map(r=>{const t=r.icon,s=M===r.key;return e.jsxs("button",{onClick:()=>V(r.key),className:"py-3 px-6 rounded-xl font-medium text-sm flex items-center space-x-3 transition-all duration-300 transform "+(s?"bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg scale-105":"bg-white/60 text-gray-600 hover:bg-white/80 hover:text-gray-800 border border-gray-200 hover:shadow-md"),children:[e.jsx(t,{size:18}),e.jsx("span",{children:r.label})]},r.key)})})]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl border border-blue-100 p-4 mb-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg shadow-md",children:e.jsx(x,{size:20,className:"text-white"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-blue-800 font-medium",children:"操作提示"}),e.jsx("p",{className:"text-blue-600 text-sm",children:"点击表格单元格可直接编辑数据，支持多行文本输入"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-pulse"}),e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-pulse delay-100"}),e.jsx("div",{className:"w-2 h-2 bg-indigo-400 rounded-full animate-pulse delay-200"})]})]})}),e.jsxs("div",{className:"space-y-6",children:["planning"===M&&e.jsxs("div",{id:"planning-table",className:"overflow-x-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 p-6 bg-gradient-to-r from-blue-50/80 to-indigo-50/80 backdrop-blur-sm rounded-3xl shadow-xl border border-gray-100",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl shadow-lg",children:e.jsx(a,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"年度工作规划表"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"年度工作安排与资源分配计划"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-gray-500 text-sm",children:"数据记录"}),e.jsxs("div",{className:"text-blue-600 font-semibold",children:[G.data.length," 条规划"]})]}),e.jsx("div",{className:"flex space-x-3",children:e.jsxs("button",{onClick:()=>Z("planning"),className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl hover:from-blue-600 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center space-x-2",children:[e.jsx(h,{size:18}),e.jsx("span",{children:"保存"})]})})]})]}),e.jsxs("table",{className:"w-full border-collapse rounded-3xl overflow-hidden shadow-2xl",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-blue-100/80 to-blue-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/50",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(i,{size:16}),e.jsx("span",{children:"月份"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-blue-100/80 to-blue-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/50",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(a,{size:16}),e.jsx("span",{children:"主题"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-green-100/80 to-green-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/50",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(m,{size:16}),e.jsx("span",{children:"目标"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-green-100/80 to-green-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/50",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(p,{size:16}),e.jsx("span",{children:"主要任务"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-yellow-100/80 to-yellow-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/50",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(b,{size:16}),e.jsx("span",{children:"资源需求"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-yellow-100/80 to-yellow-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/50",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(g,{size:16}),e.jsx("span",{children:"时间安排"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-purple-100/80 to-purple-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/50",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(y,{size:16}),e.jsx("span",{children:"负责人"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-purple-100/80 to-purple-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(u,{size:16}),e.jsx("span",{children:"备注"})]})})]})}),e.jsx("tbody",{children:G.data.map((r,t)=>e.jsxs("tr",{className:"group hover:bg-gradient-to-r hover:from-blue-50/80 hover:to-indigo-50/80 transition-all duration-300 border-b border-gray-100/50",children:[e.jsx("td",{className:"px-6 py-4 font-bold text-center bg-gradient-to-r from-blue-50/60 to-blue-100/60 border-r border-gray-200/30 group-hover:from-blue-100/80 group-hover:to-blue-200/80 transition-colors duration-300",children:e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full text-white shadow-md",children:r.month})}),e.jsx("td",{className:"px-6 py-4 font-semibold text-center border-r border-gray-200/30 group-hover:bg-white/50 transition-colors duration-300",children:r.theme}),e.jsx("td",{className:"px-6 py-4 border-r border-gray-200/30 group-hover:bg-white/30 transition-colors duration-300",children:e.jsx(re,{sheet:"planning",index:t,field:"goals",value:r.goals,type:"textarea"})}),e.jsx("td",{className:"px-6 py-4 border-r border-gray-200/30 group-hover:bg-white/30 transition-colors duration-300",children:e.jsx(re,{sheet:"planning",index:t,field:"tasks",value:r.tasks,type:"textarea"})}),e.jsx("td",{className:"px-6 py-4 border-r border-gray-200/30 group-hover:bg-white/30 transition-colors duration-300",children:e.jsx(re,{sheet:"planning",index:t,field:"resources",value:r.resources,type:"textarea"})}),e.jsx("td",{className:"px-6 py-4 border-r border-gray-200/30 group-hover:bg-white/30 transition-colors duration-300",children:e.jsx(re,{sheet:"planning",index:t,field:"timeline",value:r.timeline})}),e.jsx("td",{className:"px-6 py-4 border-r border-gray-200/30 group-hover:bg-white/30 transition-colors duration-300",children:e.jsx(re,{sheet:"planning",index:t,field:"responsible",value:r.responsible})}),e.jsx("td",{className:"px-6 py-4 group-hover:bg-white/30 transition-colors duration-300",children:e.jsx(re,{sheet:"planning",index:t,field:"notes",value:r.notes,type:"textarea"})})]},t))})]})]}),"events"===M&&e.jsxs("div",{id:"events-table",className:"overflow-x-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8 p-6 bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl border border-gray-200/30",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-4 bg-gradient-to-r from-purple-500/90 to-pink-600/90 rounded-2xl shadow-xl",children:e.jsx(j,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"年度大事件提炼表"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"重要事件记录与分析总结"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm text-gray-500 bg-white/50 px-3 py-1 rounded-full border border-gray-200/30",children:["共 ",L.events.length," 条记录"]}),e.jsxs("button",{onClick:()=>Z("events"),className:"px-8 py-3 bg-gradient-to-r from-blue-500/90 to-purple-600/90 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 flex items-center space-x-2",children:[e.jsx(h,{className:"w-5 h-5"}),e.jsx("span",{children:"保存"})]})]})]}),e.jsxs("table",{className:"w-full border-collapse rounded-3xl overflow-hidden shadow-2xl",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-blue-100/80 to-blue-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/30",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(i,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:"月份"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-green-100/80 to-green-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/30",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(a,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"事件名称"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-green-100/80 to-green-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/30",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(f,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"事件类型"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-yellow-100/80 to-yellow-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/30",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(v,{className:"w-4 h-4 text-yellow-600"}),e.jsx("span",{children:"重要程度"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-yellow-100/80 to-yellow-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/30",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(N,{className:"w-4 h-4 text-yellow-600"}),e.jsx("span",{children:"事件描述"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-purple-100/80 to-purple-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/30",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(w,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"影响分析"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-purple-100/80 to-purple-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(k,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"经验教训"})]})})]})}),e.jsx("tbody",{children:L.events.map((r,t)=>e.jsxs("tr",{className:"group hover:bg-gradient-to-r hover:from-purple-50/80 hover:to-pink-50/80 transition-all duration-300 border-b border-gray-100/50",children:[e.jsx("td",{className:"px-6 py-4 font-bold text-center bg-gradient-to-r from-blue-50/60 to-blue-100/60 border-r border-gray-200/30 group-hover:from-blue-100/80 group-hover:to-blue-200/80 transition-colors duration-300",children:e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full text-white shadow-md",children:r.month})}),e.jsx("td",{className:"px-6 py-4 font-semibold border-r border-gray-200/30 group-hover:bg-white/50 transition-colors duration-300",children:e.jsx(re,{sheet:"events",index:t,field:"event_name",value:r.event_name})}),e.jsx("td",{className:"px-6 py-4 border-r border-gray-200/30 group-hover:bg-white/30 transition-colors duration-300",children:e.jsx(re,{sheet:"events",index:t,field:"event_type",value:r.event_type})}),e.jsx("td",{className:"px-6 py-4 border-r border-gray-200/30 group-hover:bg-white/30 transition-colors duration-300",children:e.jsx(re,{sheet:"events",index:t,field:"importance",value:r.importance})}),e.jsx("td",{className:"px-6 py-4 border-r border-gray-200/30 group-hover:bg-white/30 transition-colors duration-300",children:e.jsx(re,{sheet:"events",index:t,field:"description",value:r.description,type:"textarea"})}),e.jsx("td",{className:"px-6 py-4 border-r border-gray-200/30 group-hover:bg-white/30 transition-colors duration-300",children:e.jsx(re,{sheet:"events",index:t,field:"impact",value:r.impact,type:"textarea"})}),e.jsx("td",{className:"px-6 py-4 group-hover:bg-white/30 transition-colors duration-300",children:e.jsx(re,{sheet:"events",index:t,field:"lessons",value:r.lessons,type:"textarea"})})]},t))})]})]}),"monthly"===M&&e.jsxs("div",{id:"monthly-table",className:"overflow-x-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8 p-6 bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl border border-gray-200/30",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-4 bg-gradient-to-r from-yellow-500/90 to-orange-600/90 rounded-2xl shadow-xl",children:e.jsx(w,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 bg-gradient-to-r from-yellow-600 to-orange-600 bg-clip-text text-transparent",children:"月度推进计划表"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"月度目标分解与执行计划"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm text-gray-500 bg-white/50 px-3 py-1 rounded-full border border-gray-200/30",children:["共 ",T.plans.length," 条记录"]}),e.jsxs("button",{onClick:()=>Z("monthly"),className:"px-8 py-3 bg-gradient-to-r from-blue-500/90 to-purple-600/90 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 flex items-center space-x-2",children:[e.jsx(h,{className:"w-5 h-5"}),e.jsx("span",{children:"保存"})]})]})]}),e.jsxs("table",{className:"w-full border-collapse rounded-3xl overflow-hidden shadow-2xl",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-blue-100/80 to-blue-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/30",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(i,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:"月份"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-green-100/80 to-green-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/30",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(m,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"目标"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-green-100/80 to-green-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/30",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(z,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"关键任务"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-yellow-100/80 to-yellow-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/30",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(b,{className:"w-4 h-4 text-yellow-600"}),e.jsx("span",{children:"交付成果"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-yellow-100/80 to-yellow-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/30",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(_,{className:"w-4 h-4 text-yellow-600"}),e.jsx("span",{children:"里程碑"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-purple-100/80 to-purple-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/30",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(C,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"资源需求"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-purple-100/80 to-purple-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center border-r border-gray-200/30",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(j,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{children:"风险点"})]})}),e.jsx("th",{className:"px-6 py-4 bg-gradient-to-r from-red-100/80 to-red-200/80 backdrop-blur-sm text-sm font-semibold text-gray-800 text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(D,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{children:"成功指标"})]})})]})}),e.jsx("tbody",{children:T.plans.map((r,t)=>e.jsxs("tr",{className:"group border-b border-gray-200/30 hover:bg-gradient-to-r from-yellow-50/50 to-orange-50/50 transition-all duration-300 hover:shadow-md",children:[e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 border-r border-gray-200/30 group-hover:border-gray-200/50 transition-colors",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-white text-xs font-bold",children:t+1})}),e.jsxs("span",{className:"font-bold",children:[r.month,"月"]})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 border-r border-gray-200/30 group-hover:border-gray-200/50 transition-colors",children:e.jsx(re,{sheet:"monthly",index:t,field:"objectives",value:r.objectives,type:"textarea"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 border-r border-gray-200/30 group-hover:border-gray-200/50 transition-colors",children:e.jsx(re,{sheet:"monthly",index:t,field:"key_tasks",value:r.key_tasks,type:"textarea"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 border-r border-gray-200/30 group-hover:border-gray-200/50 transition-colors",children:e.jsx(re,{sheet:"monthly",index:t,field:"deliverables",value:r.deliverables,type:"textarea"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 border-r border-gray-200/30 group-hover:border-gray-200/50 transition-colors",children:e.jsx(re,{sheet:"monthly",index:t,field:"milestones",value:r.milestones,type:"textarea"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 border-r border-gray-200/30 group-hover:border-gray-200/50 transition-colors",children:e.jsx(re,{sheet:"monthly",index:t,field:"resources_needed",value:r.resources_needed,type:"textarea"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 border-r border-gray-200/30 group-hover:border-gray-200/50 transition-colors",children:e.jsx(re,{sheet:"monthly",index:t,field:"risks",value:r.risks,type:"textarea"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 group-hover:border-gray-200/50 transition-colors",children:e.jsx(re,{sheet:"monthly",index:t,field:"success_metrics",value:r.success_metrics,type:"textarea"})})]},t))})]})]}),"action"===M&&e.jsxs("div",{id:"action-table",className:"overflow-x-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-pink-600 rounded-lg",children:e.jsx(m,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"5W2H行动计划表"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"详细行动计划与执行方案"})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:te,className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-200 transform hover:scale-105 shadow-lg flex items-center space-x-2",children:[e.jsx(F,{size:18}),e.jsx("span",{children:"新增计划"})]}),e.jsxs("button",{onClick:()=>Z("action"),className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-200 transform hover:scale-105 shadow-lg flex items-center space-x-2",children:[e.jsx(h,{size:18}),e.jsx("span",{children:"保存"})]})]})]}),e.jsxs("table",{className:"w-full border-collapse rounded-xl overflow-hidden shadow-lg",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{className:"px-4 py-3 bg-gradient-to-r from-blue-100 to-blue-200 text-sm font-semibold text-gray-800 text-center border border-gray-200",children:["What",e.jsx("br",{}),"做什么"]}),e.jsxs("th",{className:"px-4 py-3 bg-gradient-to-r from-green-100 to-green-200 text-sm font-semibold text-gray-800 text-center border border-gray-200",children:["Why",e.jsx("br",{}),"为什么"]}),e.jsxs("th",{className:"px-4 py-3 bg-gradient-to-r from-green-100 to-green-200 text-sm font-semibold text-gray-800 text-center border border-gray-200",children:["Who",e.jsx("br",{}),"谁来做"]}),e.jsxs("th",{className:"px-4 py-3 bg-gradient-to-r from-yellow-100 to-yellow-200 text-sm font-semibold text-gray-800 text-center border border-gray-200",children:["When",e.jsx("br",{}),"什么时候"]}),e.jsxs("th",{className:"px-4 py-3 bg-gradient-to-r from-yellow-100 to-yellow-200 text-sm font-semibold text-gray-800 text-center border border-gray-200",children:["Where",e.jsx("br",{}),"在哪里"]}),e.jsxs("th",{className:"px-4 py-3 bg-gradient-to-r from-purple-100 to-purple-200 text-sm font-semibold text-gray-800 text-center border border-gray-200",children:["How",e.jsx("br",{}),"怎么做"]}),e.jsxs("th",{className:"px-4 py-3 bg-gradient-to-r from-purple-100 to-purple-200 text-sm font-semibold text-gray-800 text-center border border-gray-200",children:["How Much",e.jsx("br",{}),"成本多少"]}),e.jsx("th",{className:"px-4 py-3 bg-gradient-to-r from-red-100 to-red-200 text-sm font-semibold text-gray-800 text-center border border-gray-200",children:"状态"}),e.jsx("th",{className:"px-4 py-3 bg-gradient-to-r from-gray-100 to-gray-200 text-sm font-semibold text-gray-800 text-center border border-gray-200 no-print",children:"操作"})]})}),e.jsx("tbody",{children:q.actions.map((r,t)=>e.jsxs("tr",{className:"hover:bg-gradient-to-r from-blue-50/50 to-indigo-50/50 transition-all duration-200 border-b border-gray-100",children:[e.jsx("td",{className:"px-4 py-3 border border-gray-200",children:e.jsx(re,{sheet:"action",index:t,field:"what",value:r.what,type:"textarea"})}),e.jsx("td",{className:"px-4 py-3 border border-gray-200",children:e.jsx(re,{sheet:"action",index:t,field:"why",value:r.why,type:"textarea"})}),e.jsx("td",{className:"px-4 py-3 border border-gray-200",children:e.jsx(re,{sheet:"action",index:t,field:"who",value:r.who})}),e.jsx("td",{className:"px-4 py-3 border border-gray-200",children:e.jsx(re,{sheet:"action",index:t,field:"when",value:r.when})}),e.jsx("td",{className:"px-4 py-3 border border-gray-200",children:e.jsx(re,{sheet:"action",index:t,field:"where",value:r.where})}),e.jsx("td",{className:"px-4 py-3 border border-gray-200",children:e.jsx(re,{sheet:"action",index:t,field:"how",value:r.how,type:"textarea"})}),e.jsx("td",{className:"px-4 py-3 border border-gray-200",children:e.jsx(re,{sheet:"action",index:t,field:"how_much",value:r.how_much})}),e.jsx("td",{className:"px-4 py-3 border border-gray-200",children:e.jsx(re,{sheet:"action",index:t,field:"status",value:r.status})}),e.jsx("td",{className:"px-4 py-3 border border-gray-200 no-print",children:e.jsx("button",{onClick:()=>(e=>{I(r=>({...r,actions:r.actions.filter((r,t)=>t!==e)}))})(t),className:"text-red-600 hover:text-red-800 transition-all duration-200 transform hover:scale-110",title:"删除",children:e.jsx(P,{size:18})})})]},t))})]})]})]}),K&&e.jsx(W,{isOpen:K,title:`${R.find(e=>e.key===M)?.label} (${(new Date).getFullYear()}年)`,data:{planning:G.data,events:L.events,monthly:T.plans,action:q.actions}[M]||[],columns:{planning:[{key:"month",label:"月份"},{key:"target",label:"目标"},{key:"plan",label:"计划"},{key:"responsible",label:"责任人"},{key:"deadline",label:"完成时间"},{key:"status",label:"状态"}],events:[{key:"month",label:"月份"},{key:"event",label:"大事件"},{key:"description",label:"事件描述"},{key:"impact",label:"影响程度"},{key:"responsible",label:"负责人"},{key:"status",label:"状态"}],monthly:[{key:"month",label:"月份"},{key:"target",label:"目标"},{key:"plan",label:"计划"},{key:"responsible",label:"责任人"},{key:"deadline",label:"完成时间"},{key:"progress",label:"进度"}],action:[{key:"what",label:"What (做什么)"},{key:"why",label:"Why (为什么)"},{key:"who",label:"Who (谁来做)"},{key:"when",label:"When (什么时候)"},{key:"where",label:"Where (在哪里)"},{key:"how",label:"How (怎么做)"},{key:"how_much",label:"How Much (多少钱)"},{key:"status",label:"状态"}]}[M]||[],filename:`${R.find(e=>e.key===M)?.label}_${(new Date).getFullYear()}`,onClose:()=>E(!1)})]})};export{A as default};

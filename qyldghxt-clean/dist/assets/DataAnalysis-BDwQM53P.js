import{a as e,j as t}from"./index-ByQWdRVi.js";import{r,b as a,B as s,C as o,X as l,Y as i,T as d,L as n,c as x,d as c,e as m,P as g,f as h,g as u}from"./charts--DrkC4h1.js";import{b,c as p,B as f,h as j,T as v,A as w,C as N}from"./ui-CyUNfsEX.js";import"./vendor-De9qiMg1.js";import"./router-BWTJJsff.js";import"./pdf-60kGjG4V.js";import"./utils-d68qSfg_.js";const y=()=>{const{getDepartmentTargets:y,getMajorEvents:k,getMonthlyProgress:S,getAnnualWorkPlans:z,getDepartments:F,getEmployees:K}=e(),[$,D]=r.useState(!0),[R,W]=r.useState([]),[B,C]=r.useState([]),[E,L]=r.useState([]),[P,_]=r.useState([]),[T,A]=r.useState([]),[I,M]=r.useState([]);r.useEffect(()=>{O()},[]);const O=async()=>{D(!0);try{const[e,t,r,a,s,o]=await Promise.all([y(),k(),S(),z(),F(),K()]);W(e.data||[]),C(t.data||[]),L(r.data||[]),_(a.data||[]),A(s.data||[]),M(o.data||[])}catch(e){console.error("Failed to load data:",e)}finally{D(!1)}},X=R.reduce((e,t)=>{const r=t.month||0;return e[r]||(e[r]={month:`${r}月`,amount:0,profit:0}),e[r].amount+=t.sales_amount||0,e[r].profit+=t.profit||0,e},{}),Y=Object.values(X).sort((e,t)=>parseInt(e.month)-parseInt(t.month)),q=T.map(e=>{const t=R.filter(t=>t.department===e.name),r=t.reduce((e,t)=>e+(t.sales_amount||0),0),a=t.reduce((e,t)=>e+(t.profit||0),0),s=t.reduce((e,t)=>e+(t.staff_count||0),0);return{name:e.name,"销售额":r,"利润":a,"人均产值":s>0?a/s:0}}),G=E.map(e=>({name:e.target||"目标","完成率":100*(e.completion_progress||0)})).slice(0,10),H=B.reduce((e,t)=>{const r=t.dimension||"其他";return e[r]=(e[r]||0)+1,e},{}),J=Object.entries(H).map(([e,t])=>({name:e,value:t})),Q=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"];return $?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"relative bg-gradient-to-br from-blue-600 via-purple-600 to-indigo-700 rounded-2xl shadow-2xl p-8 text-white overflow-hidden",children:[t.jsxs("div",{className:"absolute top-0 left-0 w-full h-full opacity-10",children:[t.jsx("div",{className:"absolute top-10 left-10 w-32 h-32 bg-white rounded-full animate-blob"}),t.jsx("div",{className:"absolute bottom-10 right-10 w-24 h-24 bg-white rounded-full animate-blob animation-delay-2000"}),t.jsx("div",{className:"absolute top-1/2 left-1/2 w-20 h-20 bg-white rounded-full animate-blob animation-delay-4000"})]}),t.jsxs("div",{className:"relative flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center mb-3",children:[t.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-300 to-purple-300 rounded-xl mr-4",children:t.jsx(b,{size:28,className:"text-white"})}),t.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-white to-blue-100 bg-clip-text text-transparent",children:"数据分析"})]}),t.jsx("p",{className:"text-blue-100 text-lg",children:"企业年度规划数据综合分析"})]}),t.jsxs("button",{onClick:O,className:"px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-xl hover:from-yellow-600 hover:to-orange-600 transition-all duration-200 transform hover:scale-105 shadow-lg flex items-center space-x-2",children:[t.jsx(p,{size:18}),t.jsx("span",{children:"刷新数据"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-gray-50 rounded-2xl shadow-lg p-6 cursor-pointer hover:shadow-xl transition-all duration-300 hover:-translate-y-1 border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/5 to-purple-500/5 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),t.jsxs("div",{className:"relative flex items-center",children:[t.jsx("div",{className:"p-4 rounded-2xl bg-gradient-to-r from-blue-500 to-purple-500 shadow-lg group-hover:scale-110 transition-transform duration-300",children:t.jsx(f,{size:28,className:"text-white"})}),t.jsxs("div",{className:"ml-5",children:[t.jsx("p",{className:"text-3xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent",children:T.length}),t.jsx("p",{className:"text-gray-600 font-medium mt-1",children:"部门数量"})]})]}),t.jsx("div",{className:"absolute bottom-0 left-0 w-0 h-1 bg-gradient-to-r from-blue-500 to-purple-500 group-hover:w-full transition-all duration-500 rounded-full"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-gray-50 rounded-2xl shadow-lg p-6 cursor-pointer hover:shadow-xl transition-all duration-300 hover:-translate-y-1 border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-green-500/5 to-blue-500/5 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),t.jsxs("div",{className:"relative flex items-center",children:[t.jsx("div",{className:"p-4 rounded-2xl bg-gradient-to-r from-green-500 to-blue-500 shadow-lg group-hover:scale-110 transition-transform duration-300",children:t.jsx(j,{size:28,className:"text-white"})}),t.jsxs("div",{className:"ml-5",children:[t.jsx("p",{className:"text-3xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent",children:I.length}),t.jsx("p",{className:"text-gray-600 font-medium mt-1",children:"员工总数"})]})]}),t.jsx("div",{className:"absolute bottom-0 left-0 w-0 h-1 bg-gradient-to-r from-green-500 to-blue-500 group-hover:w-full transition-all duration-500 rounded-full"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-gray-50 rounded-2xl shadow-lg p-6 cursor-pointer hover:shadow-xl transition-all duration-300 hover:-translate-y-1 border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-500/5 to-pink-500/5 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),t.jsxs("div",{className:"relative flex items-center",children:[t.jsx("div",{className:"p-4 rounded-2xl bg-gradient-to-r from-purple-500 to-pink-500 shadow-lg group-hover:scale-110 transition-transform duration-300",children:t.jsx(v,{size:28,className:"text-white"})}),t.jsxs("div",{className:"ml-5",children:[t.jsx("p",{className:"text-3xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent",children:R.length}),t.jsx("p",{className:"text-gray-600 font-medium mt-1",children:"目标数量"})]})]}),t.jsx("div",{className:"absolute bottom-0 left-0 w-0 h-1 bg-gradient-to-r from-purple-500 to-pink-500 group-hover:w-full transition-all duration-500 rounded-full"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-gray-50 rounded-2xl shadow-lg p-6 cursor-pointer hover:shadow-xl transition-all duration-300 hover:-translate-y-1 border border-gray-100",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-500/5 to-orange-500/5 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),t.jsxs("div",{className:"relative flex items-center",children:[t.jsx("div",{className:"p-4 rounded-2xl bg-gradient-to-r from-red-500 to-orange-500 shadow-lg group-hover:scale-110 transition-transform duration-300",children:t.jsx(w,{size:28,className:"text-white"})}),t.jsxs("div",{className:"ml-5",children:[t.jsx("p",{className:"text-3xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent",children:B.length}),t.jsx("p",{className:"text-gray-600 font-medium mt-1",children:"大事件数量"})]})]}),t.jsx("div",{className:"absolute bottom-0 left-0 w-0 h-1 bg-gradient-to-r from-red-500 to-orange-500 group-hover:w-full transition-all duration-500 rounded-full"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"group relative bg-gradient-to-br from-white/80 to-blue-50/80 backdrop-blur-sm rounded-3xl shadow-2xl p-6 border border-white/20 hover:shadow-2xl transition-all duration-300 hover:-translate-y-1",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-purple-500 rounded-2xl shadow-lg mr-4",children:t.jsx(p,{size:24,className:"text-white"})}),t.jsx("h3",{className:"text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent",children:"月度销售额趋势"})]}),t.jsx("div",{className:"text-sm font-medium bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"实时数据"})]}),t.jsx(a,{width:"100%",height:300,children:t.jsxs(s,{data:Y,children:[t.jsx(o,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),t.jsx(l,{dataKey:"month",stroke:"#666",fontSize:12}),t.jsx(i,{stroke:"#666",fontSize:12}),t.jsx(d,{formatter:e=>`¥${e.toLocaleString()}`,contentStyle:{background:"rgba(255, 255, 255, 0.95)",border:"none",borderRadius:"12px",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"}}),t.jsx(n,{}),t.jsx(x,{dataKey:"amount",fill:"#8884d8",name:"销售额",radius:[4,4,0,0]}),t.jsx(x,{dataKey:"profit",fill:"#82ca9d",name:"利润",radius:[4,4,0,0]})]})})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-white/80 to-green-50/80 backdrop-blur-sm rounded-3xl shadow-2xl p-6 border border-white/20 hover:shadow-2xl transition-all duration-300 hover:-translate-y-1",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"p-3 bg-gradient-to-r from-green-500 to-blue-500 rounded-2xl shadow-lg mr-4",children:t.jsx(b,{size:24,className:"text-white"})}),t.jsx("h3",{className:"text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent",children:"部门业绩对比"})]}),t.jsx("div",{className:"text-sm font-medium bg-gradient-to-r from-green-600 to-blue-600 bg-clip-text text-transparent",children:"多维度分析"})]}),t.jsx(a,{width:"100%",height:300,children:t.jsxs(c,{data:q,children:[t.jsx(o,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),t.jsx(l,{dataKey:"name",stroke:"#666",fontSize:12}),t.jsx(i,{stroke:"#666",fontSize:12}),t.jsx(d,{formatter:e=>`¥${e.toLocaleString()}`,contentStyle:{background:"rgba(255, 255, 255, 0.95)",border:"none",borderRadius:"12px",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"}}),t.jsx(n,{}),t.jsx(m,{type:"monotone",dataKey:"销售额",stroke:"#8884d8",strokeWidth:3,dot:{fill:"#8884d8",strokeWidth:2,r:4}}),t.jsx(m,{type:"monotone",dataKey:"利润",stroke:"#82ca9d",strokeWidth:3,dot:{fill:"#82ca9d",strokeWidth:2,r:4}})]})})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-white/80 to-purple-50/80 backdrop-blur-sm rounded-3xl shadow-2xl p-6 border border-white/20 hover:shadow-2xl transition-all duration-300 hover:-translate-y-1",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl shadow-lg mr-4",children:t.jsx(v,{size:24,className:"text-white"})}),t.jsx("h3",{className:"text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent",children:"进度完成率"})]}),t.jsx("div",{className:"text-sm font-medium bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"目标追踪"})]}),t.jsx(a,{width:"100%",height:300,children:t.jsxs(s,{data:G,children:[t.jsx(o,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),t.jsx(l,{dataKey:"name",stroke:"#666",fontSize:12}),t.jsx(i,{stroke:"#666",fontSize:12}),t.jsx(d,{formatter:e=>`${e.toFixed(1)}%`,contentStyle:{background:"rgba(255, 255, 255, 0.95)",border:"none",borderRadius:"12px",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"}}),t.jsx(n,{}),t.jsx(x,{dataKey:"完成率",fill:"#8884d8",radius:[4,4,0,0]})]})})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-white/80 to-orange-50/80 backdrop-blur-sm rounded-3xl shadow-2xl p-6 border border-white/20 hover:shadow-2xl transition-all duration-300 hover:-translate-y-1",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"p-3 bg-gradient-to-r from-orange-500 to-red-500 rounded-2xl shadow-lg mr-4",children:t.jsx(w,{size:24,className:"text-white"})}),t.jsx("h3",{className:"text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent",children:"大事件分布"})]}),t.jsx("div",{className:"text-sm font-medium bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent",children:"事件分析"})]}),t.jsx(a,{width:"100%",height:300,children:t.jsxs(g,{children:[t.jsx(h,{data:J,cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:t})=>`${e}: ${(100*t).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:J.map((e,r)=>t.jsx(u,{fill:Q[r%Q.length]},`cell-${r}`))}),t.jsx(d,{contentStyle:{background:"rgba(255, 255, 255, 0.95)",border:"none",borderRadius:"12px",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"}})]})})]})]}),t.jsxs("div",{className:"bg-gradient-to-br from-white/80 to-gray-50/80 backdrop-blur-sm rounded-3xl shadow-2xl p-8 border border-white/20",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"p-3 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-2xl shadow-lg mr-4",children:t.jsx(b,{size:24,className:"text-white"})}),t.jsx("h3",{className:"text-xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent",children:"数据汇总"})]}),t.jsx("div",{className:"text-sm font-medium bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent",children:"关键指标"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-blue-50 rounded-2xl shadow-lg p-6 border border-blue-100 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-sm mb-2 font-medium",children:"计划数"}),t.jsx("p",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-blue-800 bg-clip-text text-transparent",children:P.length})]}),t.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl shadow-md",children:t.jsx(N,{size:20,className:"text-white"})})]}),t.jsx("div",{className:"absolute bottom-0 left-0 w-0 h-1 bg-gradient-to-r from-blue-500 to-blue-600 group-hover:w-full transition-all duration-500 rounded-full"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-green-50 rounded-2xl shadow-lg p-6 border border-green-100 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-sm mb-2 font-medium",children:"推进计划"}),t.jsx("p",{className:"text-3xl font-bold bg-gradient-to-r from-green-600 to-green-800 bg-clip-text text-transparent",children:E.length})]}),t.jsx("div",{className:"p-3 bg-gradient-to-r from-green-500 to-green-600 rounded-xl shadow-md",children:t.jsx(p,{size:20,className:"text-white"})})]}),t.jsx("div",{className:"absolute bottom-0 left-0 w-0 h-1 bg-gradient-to-r from-green-500 to-green-600 group-hover:w-full transition-all duration-500 rounded-full"})]}),t.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-purple-50 rounded-2xl shadow-lg p-6 border border-purple-100 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-sm mb-2 font-medium",children:"大事件"}),t.jsx("p",{className:"text-3xl font-bold bg-gradient-to-r from-purple-600 to-purple-800 bg-clip-text text-transparent",children:B.length})]}),t.jsx("div",{className:"p-3 bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl shadow-md",children:t.jsx(w,{size:20,className:"text-white"})})]}),t.jsx("div",{className:"absolute bottom-0 left-0 w-0 h-1 bg-gradient-to-r from-purple-500 to-purple-600 group-hover:w-full transition-all duration-500 rounded-full"})]})]})]})]})};export{y as default};
